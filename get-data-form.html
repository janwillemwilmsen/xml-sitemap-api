<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
<!-- Start Live Server in VS code -->

<h1>Get XML urls</h1>    
<!-- <form  action="http://localhost:3000/sitemap?" method="POST"> -->
    <form>
    <!-- <input type="text" id="API_URL" name="API_URL" value="http://localhost:3000/sitemap?xmlsitemap=https://toertocht.be/sitemap.xml"> -->
    <input type="text" id="xmlsitemap" name="xmlsitemap" value="https://toertocht.be/sitemap.xml">
    <!-- <input type="submit" value="submit to xmlSitemap api"> -->
    <button>Submit</button>
</form>

<ul>

</ul>

<script>
    var form = document.querySelector('form');
    var data = new FormData(form);
    var myList = document.querySelector('ul');

// // https://cryptic-headland-94862.herokuapp.com

// // fetch('toertocht.be.json', {mode:'cors'})
// // fetch('http://localhost:3000/sitemap?xmlsitemap=http://127.0.0.1:5500/toertocht.be.json')
// // fetch('http://localhost:3000/sitemap?xmlsitemap=http://127.0.0.1:5500/sitemap.xml')
// fetch('http://localhost:3000/sitemap?xmlsitemap=https://toertocht.be/sitemap.xml')
// // fetch('http://localhost:3000/sitemap?xmlsitemap=https://essent.nl/content/sitemap.xml')
// // .then(response => response.json())
// .then(data => console.log(data.url))
// // .then(data => console.log(data.sites))
// .then(data => console.log(data))
// // .then(blob => blob.json())
// //   .then(data => {
// //     console.table(data);
// //     return data;
// //   })
// .then(function(json) {
     
//         var listItem = document.createElement('li');
//         listItem.innerHTML = '<strong>' + json + '</strong>';
        
//         myList.appendChild(listItem);
      
//     })
// // .then(function(json) {
// //       for(var i = 0; i < json.sites.length; i++) {
// //         var listItem = document.createElement('li');
// //         listItem.innerHTML = '<strong>' + json.sites[i] + '</strong>';
// //         listItem.innerHTML +=' can be found in ' + json.products[i].Location + '.';
// //         listItem.innerHTML +=' Cost: <strong>Â£' + json.products[i].Price + '</strong>';
// //         myList.appendChild(listItem);
// //       }
// //     })

// const API_URL = document.getElementsByName("API_URL")[0].value;

// const API_URL = 'http://localhost:3000/sitemap?xmlsitemap=https://www.vattenfall.nl/sitemap.xml';
// const API_URL = 'http://localhost:3000/sitemap?xmlsitemap=https://essent.nl/content/sitemap.xml';
// const API_URL = 'http://localhost:3000/sitemap?xmlsitemap=https://toertocht.be/sitemap.xml';

// ============


// document.addEventListener('submit', function (event) {
// event.preventDefault();

// async function fetchUsers() {
//  try{
//    const response = await fetch('http://localhost:3000/sitemap?xmlsitemap=', {
// 		method: 'POST',
// 		API_URL: JSON.stringify(Object.fromEntries(new FormData(event.target))),
// 		headers: {
// 			'Content-type': 'application/json; charset=UTF-8'
// 		}
// 	})
//    const users = await response.json();
//    return users;
//   }catch(err){
//     console.error(err); 
//   }
// }

// fetchUsers().then(users => {
//   users; // fetched users
//   console.log(users)
//   console.log(users.url)
//   console.log(users.sites)

//   for(var i = 0; i < users.sites.length; i++) {
//     var listItem = document.createElement('li');
//     listItem.innerHTML = '<strong>' + users.sites[i] + '</strong>';
//     myList.appendChild(listItem);
//     }
// });

// });

var serializeForm = function (form) {
	var obj = {};
	var formData = new FormData(form);
	for (var key of formData.keys()) {
		obj[key] = formData.get(key);
	}
	return obj;
};

document.addEventListener('submit', function (event) {

	event.preventDefault();

	fetch('http://localhost:3000/sitemap', {
		method: 'POST',
		body: JSON.stringify(serializeForm(event.target)),
		headers: {
			'Content-type': 'application/json; charset=UTF-8'
		}
	}).then(function (response) {
		if (response.ok) {
			return response.json();
		}
		return Promise.reject(response);
	}).then(function (data) {
		console.log(data);
	}).catch(function (error) {
		console.warn(error);
	});
});
</script>
</body>
</html>